<?xml version="1.0" encoding="UTF-8"?>
<database defaultIdMethod="native" name="myne">
  <table name="user">
    <column name="id_user" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="id_facebook" type="VARCHAR" size="255"/>
    <column name="first_name" type="VARCHAR" size="255"/>
    <column name="last_name" type="VARCHAR" size="255"/>
    <column name="email" type="VARCHAR" size="255"/>
    <column name="publication" type="TINYINT" required="true" default="0" defaultExpr="0" description="0: let the publication be set by the review publication
1: only the user can see his reviews
2: only user's friends can see his reviews
3: everyone can see his reviews"/>
    <column name="status" type="TINYINT" required="true" default="1" defaultExpr="1"/>
    <column name="date" type="TIMESTAMP" required="true"/>
  </table>
  <table name="review">
    <column name="id_review" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="id_user" type="INTEGER" primaryKey="true" required="true"/>
    <column name="id_product" type="INTEGER" primaryKey="true" required="true"/>
    <column name="content" type="LONGVARCHAR" required="true"/>
    <column name="rate" type="SMALLINT" required="true"/>
    <column name="publication" type="TINYINT" required="true" description="1: only the user can see his reviews
2: only user's friends can see his reviews
3: everyone can see his reviews"/>
    <column name="date" type="TIMESTAMP" required="true"/>
    <foreign-key name="fk_review_user" foreignTable="user">
      <reference local="id_user" foreign="id_user"/>
    </foreign-key>
    <foreign-key name="fk_review_product1" foreignTable="product">
      <reference local="id_product" foreign="id_product"/>
    </foreign-key>
    <index name="fk_review_user_idx">
      <index-column name="id_user"/>
    </index>
    <index name="fk_review_product1_idx">
      <index-column name="id_product"/>
    </index>
  </table>
  <table name="product">
    <column name="id_product" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="ean_code" type="VARCHAR" size="255"/>
    <column name="name" type="VARCHAR" size="255"/>
  </table>
  <table name="comment">
    <column name="id_comment" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="id_review" type="INTEGER" primaryKey="true" required="true"/>
    <column name="id_user" type="INTEGER" primaryKey="true" required="true"/>
    <column name="content" type="LONGVARCHAR" required="true"/>
    <column name="status" type="TINYINT" required="true" default="1" defaultExpr="1"/>
    <column name="date" type="TIMESTAMP" required="true"/>
    <foreign-key name="fk_comment_review1" foreignTable="review">
      <reference local="id_review" foreign="id_review"/>
    </foreign-key>
    <foreign-key name="fk_comment_user1" foreignTable="user">
      <reference local="id_user" foreign="id_user"/>
    </foreign-key>
    <index name="fk_comment_review1_idx">
      <index-column name="id_review"/>
    </index>
    <index name="fk_comment_user1_idx">
      <index-column name="id_user"/>
    </index>
  </table>
  <table name="edition">
    <column name="id_edition" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="id_review" type="INTEGER" primaryKey="true" required="true"/>
    <column name="content" type="LONGVARCHAR" required="true"/>
    <column name="mood" type="TINYINT" required="true" description="0: neutral
1: happy
2: content
3: astone
4: fear
5: cry
6: angry"/>
    <column name="date" type="TIMESTAMP" required="true"/>
    <foreign-key name="fk_edition_review1" foreignTable="review">
      <reference local="id_review" foreign="id_review"/>
    </foreign-key>
    <index name="fk_edition_review1_idx">
      <index-column name="id_review"/>
    </index>
  </table>
  <table name="user_has_user">
    <column name="id_user" type="INTEGER" primaryKey="true" required="true"/>
    <column name="id_facebook_friend" type="VARCHAR" size="255" required="true"/>
    <foreign-key name="fk_user_has_user_user1" foreignTable="user">
      <reference local="id_user" foreign="id_user"/>
    </foreign-key>
  </table>
  <table name="customer">
    <column name="id_customer" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="name" type="VARCHAR" size="255"/>
    <column name="email" type="VARCHAR" size="255"/>
    <column name="password" type="VARCHAR" size="16"/>
    <column name="api_token" type="VARCHAR" size="16"/>
    <unique name="id_cutomer_UNIQUE">
      <unique-column name="id_customer"/>
    </unique>
  </table>
  <table name="customer_product">
    <column name="id_customer" type="INTEGER" primaryKey="true" required="true" autoIncrement="true"/>
    <column name="id_product" type="INTEGER"/>
    <foreign-key name="id_product" foreignTable="product" onDelete="cascade" onUpdate="cascade">
      <reference local="id_product" foreign="id_product"/>
    </foreign-key>
    <foreign-key name="id_customer" foreignTable="customer" onDelete="cascade" onUpdate="cascade">
      <reference local="id_customer" foreign="id_customer"/>
    </foreign-key>
    <index name="id_product_idx">
      <index-column name="id_product"/>
    </index>
  </table>
</database>